<!DOCTYPE html>
<html lang="fr">
<head>
  <title><%= content_for(:title) || "Partenaire - Idéal Reprise" %></title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag "tailwind", "inter-font", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
</head>

<body class="bg-gray-50">
  <!-- Sidebar -->
  <div id="sidebar" class="fixed inset-y-0 left-0 w-64 bg-gradient-to-b from-teal-600 to-cyan-700 text-white transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out z-50">
    <div class="flex flex-col h-full">
      <!-- Logo -->
      <div class="p-6 border-b border-white/20">
        <%= link_to mockups_partner_path, class: "flex items-center gap-3" do %>
          <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center">
            <span class="text-2xl font-bold bg-gradient-to-br from-teal-600 to-cyan-700 bg-clip-text text-transparent">I</span>
          </div>
          <span class="text-xl font-bold">IDÉAL</span>
        <% end %>
        <p class="text-teal-100 text-sm mt-1">Annuaire Partenaires</p>
      </div>

      <!-- Navigation -->
      <nav class="flex-1 overflow-y-auto py-6 px-4 space-y-2">
        <!-- Dashboard -->
        <%= link_to mockups_partner_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
          <i data-lucide="home" class="w-5 h-5"></i>
          <span>Tableau de bord</span>
        <% end %>

        <!-- Mon Profil Public -->
        <div class="mt-6">
          <p class="px-4 py-2 text-xs font-semibold text-teal-200 uppercase tracking-wider">Mon Annuaire</p>
          <%= link_to mockups_partner_profile_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_profile_path) || current_page?(edit_mockups_partner_profile_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <i data-lucide="id-card" class="w-5 h-5"></i>
            <span>Ma fiche annuaire</span>
          <% end %>

          <%= link_to preview_mockups_partner_profile_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(preview_mockups_partner_profile_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <i data-lucide="eye" class="w-5 h-5"></i>
            <span>Aperçu public</span>
          <% end %>
        </div>

        <!-- Contacts & Analytics -->
        <div class="mt-6">
          <p class="px-4 py-2 text-xs font-semibold text-teal-200 uppercase tracking-wider">Activité</p>
          <%= link_to mockups_partner_contacts_path, class: "flex items-center justify-between gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_contacts_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <div class="flex items-center gap-3">
              <i data-lucide="users" class="w-5 h-5"></i>
              <span>Mes contacts</span>
            </div>
            <span class="inline-flex items-center justify-center w-5 h-5 text-xs font-bold bg-amber-400 text-amber-900 rounded-full">5</span>
          <% end %>

          <%= link_to mockups_partner_analytics_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_analytics_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
            <span>Statistiques</span>
          <% end %>
        </div>

        <!-- Abonnement -->
        <div class="mt-6">
          <p class="px-4 py-2 text-xs font-semibold text-teal-200 uppercase tracking-wider">Abonnement</p>
          <%= link_to mockups_partner_subscription_path, class: "flex items-center justify-between gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_subscription_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <div class="flex items-center gap-3">
              <i data-lucide="badge-check" class="w-5 h-5"></i>
              <span>Mon abonnement</span>
            </div>
            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-400 text-green-900">
              Actif
            </span>
          <% end %>
        </div>

        <!-- Mon Compte -->
        <div class="mt-6">
          <p class="px-4 py-2 text-xs font-semibold text-teal-200 uppercase tracking-wider">Mon Compte</p>
          <%= link_to mockups_partner_settings_path, class: "flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/10 transition #{current_page?(mockups_partner_settings_path) ? 'bg-white/20 text-white font-semibold' : 'text-teal-100'}" do %>
            <i data-lucide="settings" class="w-5 h-5"></i>
            <span>Paramètres</span>
          <% end %>
        </div>
      </nav>

      <!-- User Footer -->
      <div class="p-4 border-t border-white/20">
        <div class="flex items-center gap-3 mb-3">
          <div class="w-10 h-10 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white font-semibold">
            SC
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-white truncate">Sophie Conseil</p>
            <p class="text-xs text-teal-200 truncate">Avocat d'affaires</p>
          </div>
        </div>
        <%= link_to mockups_login_path, class: "flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-white/10 hover:bg-white/20 transition text-sm" do %>
          <i data-lucide="log-out" class="w-4 h-4"></i>
          <span>Déconnexion</span>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="lg:ml-64">
    <!-- Top Header -->
    <header class="bg-white shadow-sm sticky top-0 z-40">
      <div class="flex items-center justify-between px-6 py-4">
        <div class="flex items-center gap-4">
          <!-- Mobile Menu Button -->
          <button id="mobile-menu-button" class="lg:hidden p-2 rounded-lg hover:bg-gray-100">
            <i data-lucide="menu" class="w-6 h-6 text-gray-600"></i>
          </button>

          <h1 class="text-xl font-bold text-gray-900"><%= content_for(:page_title) || "Tableau de bord" %></h1>
        </div>

        <div class="flex items-center gap-4">
          <!-- Notifications -->
          <%= link_to mockups_notifications_path, class: "relative p-2 text-gray-600 hover:bg-gray-100 rounded-lg" do %>
            <i data-lucide="bell" class="w-6 h-6"></i>
            <span class="absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"></span>
          <% end %>

          <!-- View Public Profile -->
          <%= link_to preview_mockups_partner_profile_path, class: "hidden sm:flex items-center gap-2 px-4 py-2 text-sm font-medium text-teal-600 hover:text-teal-700 hover:bg-teal-50 rounded-lg transition" do %>
            <i data-lucide="external-link" class="w-4 h-4"></i>
            <span>Voir mon profil public</span>
          <% end %>
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="p-6">
      <%= yield %>
    </main>
  </div>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>

  <script>
    document.addEventListener('turbo:load', function() {
      // Initialize Lucide icons
      if (typeof lucide !== 'undefined') {
        lucide.createIcons();
      }
      
      // Mobile menu toggle
      const mobileMenuButton = document.getElementById('mobile-menu-button');
      const sidebar = document.getElementById('sidebar');
      const mobileOverlay = document.getElementById('mobile-overlay');

      mobileMenuButton?.addEventListener('click', () => {
        sidebar.classList.toggle('-translate-x-full');
        mobileOverlay.classList.toggle('hidden');
      });

      mobileOverlay?.addEventListener('click', () => {
        sidebar.classList.add('-translate-x-full');
        mobileOverlay.classList.add('hidden');
      });
    });
    
    // Also run on initial load
    if (typeof lucide !== 'undefined') {
      lucide.createIcons();
    }
  </script>
</body>
</html>
