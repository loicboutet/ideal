<% content_for :title, "Mes dossiers - Repreneur - Id√©al Reprise" %>
<% content_for :page_title, "Mes dossiers" %>

<div class="space-y-6">
  <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
    <p class="text-gray-600">12 dossiers actifs ‚Ä¢ 3 r√©servations</p>
    <%= link_to mockups_buyer_pipeline_path, class: "px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition font-medium" do %>
      üìä Vue pipeline
    <% end %>
  </div>

  <!-- Alert Banner -->
  <div class="bg-buyer-50 border border-buyer-200 rounded-lg p-4">
    <div class="flex gap-3">
      <svg class="w-5 h-5 text-buyer-600 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
      </svg>
      <p class="text-sm text-buyer-800">Les r√©servations expirent automatiquement apr√®s le d√©lai imparti (timer). Vous pouvez les lib√©rer √† tout moment.</p>
    </div>
  </div>

  <!-- Filters & Sort -->
  <div class="bg-white rounded-lg p-4 border border-gray-200">
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <select class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-buyer-500">
        <option>Tous les statuts</option>
        <option>Favoris</option>
        <option>√Ä contacter</option>
        <option>√âchange d'infos</option>
        <option>Analyse</option>
        <option>N√©gociation</option>
      </select>
      <select class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-buyer-500">
        <option>Trier par: Plus r√©cent</option>
        <option>Trier par: Temps restant</option>
        <option>Trier par: CA</option>
        <option>Trier par: Statut</option>
      </select>
      <button class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
        R√©initialiser
      </button>
    </div>
  </div>

  <!-- Deals List -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    <% [
      {id: 1, name: 'L\'Amie dor√©e', desc: 'Boulangerie Paris 11e', ca: '450k‚Ç¨', status: '√Ä contacter', color: 'blue', timer: '5j', progress: 71, type: 'Direct'},
      {id: 2, name: 'La Bella Vita', desc: 'Restaurant Lyon 2e', ca: '420k‚Ç¨', status: '√âchange d\'infos', color: 'blue', timer: '28j', progress: 85, type: 'Mandat Id√©al'},
      {id: 3, name: 'Auto Pro', desc: 'Garage Toulouse 31', ca: '280k‚Ç¨', status: 'N√©gociation', color: 'green', timer: '15j', progress: 75, type: 'Mandat Partenaire'},
      {id: 4, name: 'Coiff\'Style', desc: 'Salon Bordeaux 33', ca: '180k‚Ç¨', status: 'Analyse', color: 'blue', timer: '22j', progress: 67, type: 'Direct'}
    ].each do |deal| %>
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition">
        <div class="p-4">
          <!-- Header -->
          <div class="flex items-start justify-between mb-3">
            <div class="flex-1">
              <h3 class="font-bold text-gray-900"><%= deal[:name] %></h3>
              <p class="text-sm text-gray-600"><%= deal[:desc] %></p>
            </div>
            <span class="px-2 py-1 text-xs rounded-full bg-<%= deal[:color] %>-100 text-<%= deal[:color] %>-700 flex-shrink-0">
              <%= deal[:status] %>
            </span>
          </div>

          <!-- CA & Type -->
          <div class="flex items-center gap-2 mb-3">
            <span class="text-sm text-gray-900 font-medium">CA: <%= deal[:ca] %></span>
            <span class="px-2 py-0.5 text-xs rounded bg-gray-100 text-gray-700"><%= deal[:type] %></span>
          </div>

          <!-- Timer -->
          <div class="mb-4">
            <div class="flex items-center justify-between mb-1">
              <span class="text-xs text-gray-600">Temps restant</span>
              <span class="text-xs font-semibold text-gray-900"><%= deal[:timer] %></span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
              <div class="bg-<%= deal[:color] %>-500 h-2 rounded-full transition-all" style="width: <%= deal[:progress] %>%"></div>
            </div>
          </div>

          <!-- Actions -->
          <%= link_to mockups_buyer_deal_path(deal[:id]), class: "block w-full text-center px-4 py-2 bg-buyer-600 text-white rounded-lg hover:bg-buyer-700 transition text-sm font-medium" do %>
            Voir le dossier ‚Üí
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
