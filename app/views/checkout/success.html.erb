<% content_for :title, "Paiement réussi - Idéal Reprise" %>

<div class="min-h-screen bg-gray-50 flex items-center justify-center px-4 py-16">
  <div class="max-w-lg w-full text-center">
    <!-- Success Animation -->
    <div class="relative mb-8">
      <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto">
        <svg class="w-12 h-12 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
      </div>
      <div class="absolute inset-0 flex items-center justify-center">
        <div class="w-24 h-24 bg-green-100 rounded-full animate-ping opacity-25"></div>
      </div>
    </div>

    <!-- Success Message -->
    <h1 class="text-3xl font-bold text-gray-900 mb-4">Paiement réussi !</h1>
    <p class="text-gray-600 mb-2">
      Merci pour votre confiance. Votre abonnement <strong><%= @plan&.dig(:name) || 'Premium' %></strong> est maintenant actif.
    </p>
    <p class="text-sm text-gray-500 mb-8">
      Un email de confirmation a été envoyé à <strong><%= current_user.email %></strong>
    </p>

    <!-- Plan Details -->
    <% if @plan %>
      <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
        <h3 class="font-semibold text-gray-900 mb-4">Détails de votre abonnement</h3>
        <div class="space-y-3 text-left">
          <div class="flex justify-between">
            <span class="text-gray-600">Plan</span>
            <span class="font-medium text-gray-900"><%= @plan[:name] %></span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600">Prix</span>
            <span class="font-medium text-gray-900"><%= @plan[:price] %>€/<%= @plan[:period] %></span>
          </div>
          <% if @plan[:credits] %>
            <div class="flex justify-between">
              <span class="text-gray-600">Crédits inclus</span>
              <span class="font-medium text-green-600">+<%= @plan[:credits] %> crédits</span>
            </div>
          <% end %>
          <div class="flex justify-between pt-3 border-t border-gray-200">
            <span class="text-gray-600">Prochain renouvellement</span>
            <span class="font-medium text-gray-900">
              <%= @plan[:period] == 'mois' ? 1.month.from_now.strftime('%d/%m/%Y') : 1.year.from_now.strftime('%d/%m/%Y') %>
            </span>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Next Steps -->
    <div class="bg-blue-50 rounded-xl p-6 mb-8 text-left">
      <h3 class="font-semibold text-gray-900 mb-3 flex items-center gap-2">
        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Prochaines étapes
      </h3>
      <ul class="space-y-2 text-sm text-gray-600">
        <% case current_user.role
           when 'buyer' %>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Parcourez les annonces et trouvez votre future entreprise
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Signez des NDA pour accéder aux informations confidentielles
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Utilisez le CRM pour suivre vos dossiers
          </li>
        <% when 'seller' %>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Complétez votre annonce avec un maximum d'informations
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Ajoutez vos documents financiers
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Consultez l'annuaire des repreneurs qualifiés
          </li>
        <% when 'partner' %>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Complétez votre profil partenaire
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Ajoutez votre lien Google Agenda
          </li>
          <li class="flex items-start gap-2">
            <svg class="w-4 h-4 text-green-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
            </svg>
            Votre profil est maintenant visible dans l'annuaire
          </li>
        <% end %>
      </ul>
    </div>

    <!-- Action Buttons -->
    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
      <% dashboard_path = case current_user.role
                          when 'buyer' then buyer_root_path
                          when 'seller' then seller_root_path
                          when 'partner' then partner_root_path
                          else root_path
                          end %>
      <%= link_to dashboard_path, class: "inline-flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition" do %>
        Accéder à mon espace
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
        </svg>
      <% end %>
      
      <%= link_to listings_path, class: "inline-flex items-center gap-2 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition" do %>
        Parcourir les annonces
      <% end %>
    </div>
  </div>
</div>
